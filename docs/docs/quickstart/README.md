# Quickstart

## Overview

After completing this quickstart, you'll understand the basic patterns for developing Pipedream workflows including how to:

- Trigger workflows on HTTP requests, schedules and app events (including new items in an RSS feed and new mentions on Twitter) 
- Return a custom response from your workflow on HTTP requests 
- Use npm packages and export data from Node.js code steps
- Pass data between workflow steps
- Use actions to send yourself an email, add data to Google Sheets and send a message to Slack

This guide will cover the following examples. We recommend that you complete the examples below in order. Each section will also link to a completed workflow that you can view, copy and run.

**Getting Started (~5 minutes)**

- Learn how to create a new workflow
- Understand the layout of the builder

**hello world! (~5 minutes)**

- Create a basic HTTP triggered workflow.
- Generate a unique endpoint URL 
- Send HTTP requests to the URL and inspect them
- Add a custom response to return "hello world!" on each HTTP request

**hello ${name}! (~5 minutes)**

- Modify the first example to use data passed in GET and POST requesets.
- First, pass a name as a query parameter and return it in the response
- Next, POST a JSON payload with a name and return it in the response

**Make an HTTP request from a workflow (~5 minutes)**

- Use the **GET Request** action to make an HTTP request to an API endpoint
- Test and inspect the step exports 
- Update the workflow response to return data exported by the HTTP request step

**Use an npm package (~5 minutes)**

- Replace the GET Request action with code using an npm package
- Use the `axios` npm package in a code step
- Rename the step

**Email yourself on new items in an RSS feed (~5 minutes)**

- Trigger our workflow on new items in an RSS feed
- Use an action to send an email to the account registered with Pipedream

**Get data from an API on a schedule and add to Google Sheets (~5 minutes)**

- Create a workflow triggered on a schedule
- Use the `axios` npm package to get data from an API
- Save data returned from the API to Google Sheets

**Search Twitter and post richly formatted messages to Slack (~5 minutes)**

- Create a workflow triggered on new Twitter mentions 
- Format the Tweet using Slack Block Kit
- Post the formatted message to a Slack channel

## Prerequisites

At minimum, create a free account at [https://pipedream.com](https://pipedream.com). To complete all the examples, you'll also need accounts for:

- Google Sheets
- Slack
- Twitter 

## Getting Started 

Create a new workflow by clicking the **New** button on https://pipedream.com/workflows:

![image-20210516114638660](./image-20210516114638660.png)

Pipedream will launch the workfow builder:

![image-20210516191619202](./image-20210516191619202.png)

Following is a map and explanation of the screen layout:

![image-20210516120407658](./image-20210516120407658.png)

**Pipedream Navigation:** Navigate between different sections of the Pipedream app (workflows, sources, accounts, settings, etc). You can collapse and expand this section using the arrow at the top left.

**Workflow Header:** Name your workflow, view metadata and manage sharing settings.

**Event List:** Events that trigger your workflow will be listed here (both test and live events). Select events to view the results of the execution in the *Workflow Builder* section.

**Canvas**: This is the section where you will build your workflow and view execution resuts.

**Workflow Tabs**: After saving or depoying your workflow, you will be able to switch between the builder, readme and settings for your workflow.

**Contextual Help**: Expand this tab to view contextual help for the current step.

## hello world!

In this first example, we'll create an HTTP triggered workflow that will return a custom response on each HTTP request.

To create an HTTP or webhook triggered workflow, select the **HTTP API** trigger. 

![image-20210516191641863](./image-20210516191641863.png)

Your workflow will automatically deploy and Pipedream will generate a unique endpiont URL.

![image-20210516191658770](./image-20210516191658770.png)

Any requests you make to the endpoint URL will trigger your workflow. To test it out:

1. Copy the endpoint URL generated by Pipedream (you can click to link icon to the right of the endpoint to copy to the clipboard)
2. Open a new browser tab and load the URL

![image-20210516194004679](./image-20210516194004679.png)

When you return to your workflow, you'll see the requests appear in the event list (events appear in real-time — you don't need to refresh the page). 

>  **NOTE:** When you look at the event list, you may see multiple requests — that's because modern browsers automatically request `favicon.ico` when you load a URL.

![image-20210516194042181](./image-20210516194042181.png)

When you select an event from the list, the data associated with that event will appear below each of the steps in your workflow. For the trigger, that means details related to the inbound request (e.g., URL, HTTP method, body, headers, etc) will appear. This data can also be referenced by steps in your workflow via the `steps` object. For example, to reference the HTTP body, you would access via `steps.trigger.event.body`.

![[video-to-gif output image]](https://im2.ezgif.com/tmp/ezgif-2-a8d29ac088cc.gif)

Let's write some simple code to return a custom response using Pipedream's `$respond()` function. First, click on **Run Node.js code** to add a code step.

![image-20210516194513122](./image-20210516194513122.png) 

Pipedream will add a code step to your workflow. 

![image-20210516194534525](./image-20210516194534525.png)

You can write any Node.js and include any npm package (just `require` it — there's no `npm install` required). For this example, add the following code to return a custom response:

```javascript
await $respond({
  status: 200,
  immediate: true,
  body: "hello world!"
})
```

![image-20210516194630638](./image-20210516194630638.png)

Then click the deploy button so your workflow changes will run in production on each new event:

![image-20210516194654143](./image-20210516194654143.png)

Then reload the tab where you previously loaded the endpoint URL — you the response should change to `hello world!`.

![image-20210516192801116](./image-20210516192801116.png)

Congratulations! You've built your first serverless workflow!

## hello ${name}!

Next, let's modify the previous example so we can pass a name on HTTP requests that is returned in the HTTP response. To do that, we'll pass a name as a query parameter when loading the endpoint URL.

First, modify the url and add `?name=foo` to the end. For example, `https://enlzqsw6yzpopp9.m.pipedream.net/?name=foo`.

Then load the URL to make a request to your workflow and select the event (if loading from your web browser, make sure you select the request that is not associated with `favicon.ico`). You should now see a `query` field — expand it to see the query parameter and value for the request (for our example, the parameter is `name` and the value is `foo`):

![image-20210516195623754](./image-20210516195623754.png)

Next, let's modify our custom response to use this data that was passed in our trigger event. Expand the code section of your code step if it's collapsed. Then modify the value for the `body` parameter in the `$respond()` function. Change the double quotes around `hello world!` to backticks to convert it to a template literal. Then, replace `world` with `${steps.trigger.event.query.name}` to reference the value we're passing as the query data:

```javas
await $respond({
  status: 200,
  immediate: true,
  body: `hello ${steps.trigger.event.query.name}!`
})
```

![image-20210516200708453](./image-20210516200708453.png)

Next, click the **Deploy** button, and then reload the previous URL:
![image-20210516200957262](./image-20210516200957262.png)

Your workflow will now return `hello foo!` instead of `hello world!`. You can change the value you're passing for the name to test further.

## Make an HTTP request from a workflow

So far, we've focused on catching inbound HTTP requests and manipulating the response. Next, let's review how easy it is to make an outbound HTTP request from a workflow. 

For this example, we'll continue to modify the same workflow as in the previous examples. Click on the **+** sign between the trigger and code steps to bring up the menu to add a step.

![image-20210516204038767](./image-20210516204038767.png)

Next, click on the **HTTP / Webhook** app:

![image-20210516204148639](./image-20210516204148639.png)

Then select **GET Request** (to make an HTTP GET request):

![image-20210516204229156](./image-20210516204229156.png)

Next, enter `http://api.open-notify.org/iss-now.json` as the URL. This URL is a free API provided by http://open-notify.org  to return the current position of the International Space Station (ISS). It does not require any authentication to use it.

![image-20210516210136157](./image-20210516210136157.png)

Finally, click **Deploy** and then hit the **Send Test Event** button in the trigger to run the workflow so we can test our change.

![image-20210516210434021](./image-20210516210434021.png)

Select the event that's generated on the in the event list to inspect the execution. The response from the URL is exported from the step as `$return_value` and can be inspected and referenced in future steps. Expand the `iss_position` key to see the `lattitude` and `longitude` returned by the API. If you run the workflow again, you'll see the position change for each execution

![image-20210516210735882](./image-20210516210735882.png)

Next, let's update the code step with our custom response and replace `hello ${steps.trigger.event.query.name}!` with the `lattitude` and `longitude` returned by the API. To do that, we'll set body to `steps.get_request.$return_value.iss_position` (with no quotes or backticks):

```javascript
await $respond({
  status: 200,
  immediate: true,
  body: steps.get_request.$return_value.iss_position
})
```

![image-20210516211333394](./image-20210516211333394.png)

Finally, click **Deploy** and then reload the URL in your web browser.`hello foo!` should be replaced by the JSON representing the ISS position. Each time you load the URL, the updated position will be returned.

![image-20210516211633575](./image-20210516211633575.png)

## Using npm packages

Next, let's replace the **GET request** action with a code step that uses the `axios` npm package. The result of the workflow will be the same, but this will introduce you to the pattern for using npm packages in code steps.

First, delete the **GET request** step from your workflow by clicking the **X** buttton at the top right of the step.

![image-20210516212047297](./image-20210516212047297.png)

Next, click the **+** button and add another Node.js code step (select the **Run Node.js code** option in the right column of the step selector). Your workflow should look like this:

![image-20210516212506585](./image-20210516212506585.png)

Next, let's `require` the `axios` npm package — there's no `npm install` or `package.json` required. Pipedream will automatically install any npm packages you `require`. The first line of code in the step should look like this:

```javascript
const axios = require('axios')
```

Next, let's make a `GET` request to the open-notify.org API to get the latest position of the ISS (when writing code, remember to `await` all promises):

```javascript
const response = await axios({
  method: "GET",
  url: "http://api.open-notify.org/iss-now.json"
})
```

Finally, let's `return` the data from the API to export it from the step (only exported data can be inspected in the builder and be referenced in later workflow steps). The data we want to export is in the `data` key of the the `axios` response:

```javascript
return response.data
```

Following is the complete code:

```javascript
const axios = require('axios')

const response = await axios({
  method: "GET",
  url: "http://api.open-notify.org/iss-now.json"
})

return response.data
```

Finally, let's rename our step from `steps.nodejs_1` to `steps.get_request` so we don't need to modify the last step of our workflow. Your workflow should now look like this:

![image-20210516213201525](./image-20210516213201525.png)

Next, click the **Deploy** button, and then load the endpoint URL in your browser again. You should continue to see the ISS position returned. Next, return to your workflow and select the event that corresponds with your most recent test. You should see your `steps.get_request` code step output the same result as the **GET Request** action you just replaced.

![image-20210516213527109](./image-20210516213527109.png)

When you're done with this quickstart, test out other popular npm packages like `moment`, `loadash`, `luxon` and more!

## Email yourself on new items in an RSS feed

For the next example, create a new workflow and search for the **RSS** app

![image-20210516235511476](./image-20210516235511476.png)

Click on **RSS** and thenselect the **New item in feed** trigger:

![image-20210516235609560](./image-20210516235609560.png)

For this example, let's use the feed of CNN's top stories. Add `http://rss.cnn.com/rss/cnn_topstories.rss` as the **Feed URL**. You can optionally customize the **Timer** (it controls how often to check for new items in the feed) and the **Name**. 

![image-20210517001147611](./image-20210517001147611.png) 

Next, click **Create Source**. Pipedream will instantiate the source and retrieve recent items from the RSS feed. You can use these events to help you build your workflow (you can expand the drop down menu to select a different event to help you build your workflow).

![image-20210517002158566](./image-20210517002158566.png)

Next, click **Send Test Event** to export the event for the trigger.

![image-20210517002427147](./image-20210517002427147.png)

Next, select the **Send Yourself an Email** action from the step selection menu.

![image-20210517002515704](./image-20210517002515704.png)

To configure the action:

- Set **Subject** to <code v-pre>New Item in Feed: {steps.trigger.event.title}</code>
- Set **Text** to <code v-pre>{steps.trigger.event.description}</code>
- Add the optional **Html** field and set it to <code v-pre>{steps.trigger.event.description}</code>

![image-20210517002850288](./image-20210517002850288.png)

Finally, click **Deploy** and click **Send Test Event** in the trigger again to run the workflow.

![image-20210517003047680](./image-20210517003047680.png)

Pipedream will send an email to the email address registered for your Pipedream account:

![image-20210517003138966](./image-20210517003138966.png)

Finally, to automatically run the workflow whenever a new item is detected in the RSS feed, enable the trigger.

![image-20210517003247789](./image-20210517003247789.png)

## Get data from an API on a schedule and add to Google Sheets

For the next example, we'll:

1. Retrieve the position of the International Space Station (ISS) on a schedule
2. Convert the timestamp corresponding to the position data to a Google Sheets compatible date and time
3. Save the data for each workflow execution to a new row in Google Sheets

First, create a Google Sheet with the labels `Latitude`, `Longitude`, `Timestamp`, `Date`, and `Time` in the first row:

![image-20210517195215566](image-20210517195215566.png)  

Then create a new workflow and select the **Schedule** trigger:

![image-20210517172354755](image-20210517172354755.png)

Next, add an action for the **HTTP / Webhook** app to make a **GET Request**:

![image-20210517172720517](image-20210517172720517.png)

Then set the **URL** to  `http://api.open-notify.org/iss-now.json`. Similar to our earlier example, this will get the position of the International Space Station (ISS) on each workflow invocation.

Next, update the name of the **GET Request ** action step to `steps.get_iss_position`. Then **Deploy** your changes and click **Run Now**.

![image-20210517191311655](image-20210517191311655.png)

Looking at the result for `steps.get_request`, we can see that the `timestamp` field returned by the API is not a friendly, human-readable date/time. 

![image-20210517191337820](image-20210517191337820.png)

Let's use the `luxon` npm package to generate one. Based on a quick Google Search, the datetime format expected by Google Sheets is `yyyy-MM-dd HH:mm:ss`. 

Click the **+** button to add a new step to the end of your workflow and select **Run Node.js code**. Then add the following code to convert the timestamp to a date time and export it from the code step:

```javascript
const { DateTime } = require('luxon')

return DateTime.fromSeconds(steps.get_iss_position.$return_value.timestamp).toFormat('yyyy-MM-dd HH:mm:ss');
```

Let's also go ahead and change the name of the code step to `steps.format_datetime`

![image-20210517191454552](image-20210517191454552.png)

**Deploy** your changes and click **Run Now** to test your code. You should see a human-readable date/time as the return value for `steps.format_datetime`.

![image-20210517191613816](image-20210517191613816.png)

Next click the **+** button to add a new step to the end of your workflow and select the **Google Sheets** app:

![image-20210517191755712](image-20210517191755712.png)

Select the **Add Single Row** action:

![image-20210517191836381](image-20210517191836381.png)

To configure the step, first connect your Google Sheets account. When you click on **Connect Google Sheets** Pipedream will open a popup window where you can sign in to connect your account. When you, Pipdream will secure store an OAuth token that allows actions to make API requests on your behalf (uou can also use these tokens yourself to authenticate API requests for your authenticated apps in code steps):

![image-20210517193714356](image-20210517193714356.png)

When prompted by Google, allow Pipedream access:

<img src="image-20210517181653424.png" alt="image-20210517181653424" style="zoom:25%;" />

Next, select your **Drive**, **Spreadsheet** and **Sheet Name** from the drop down menus.

![image-20210517193836076](image-20210517193836076.png)

Then let's configure the cells / column values. First, we'll use the object explorer to select a value. The object explorer is automatically loaded whenever you focus in an action input. You can expand any item and then select the reference you want to insert.

![image-20210517194614780](image-20210517194614780.png)

Another option is to explore the exports for a step and click on the **Copy Path** link. Then paste the reference into the action input.

![image-20210517194853448](image-20210517194853448.png)

The final option is to use autocomplete — add double braces `{{ }}` and start typing between them to get autocomplete the same way you do in code steps. Since we want to add four columns of data with the latitude, longitude, timestamp and the formatted date time (in that order), your fully configured step should look like this:

![image-20210517195139556](image-20210517195139556.png)

Next, **Deploy** your changes and click **Run Now**. Your workflow should execute successfully:

![](image-20210517195416793.png)

When you check Google Sheets you should see the values entered in the sheet:

![image-20210517195548983](image-20210517195548983.png)

Finally, add a workflow title, configure the schedule and click **Deploy**. Your workflow will now run automatically.

![image-20210517195924673](image-20210517195924673.png) 

## Write Code with Github Managed Auth 

In the previous example, we used Pipedream managed auth in an action. You can also use the OAuth token or key you connect to Pipdream directly in code to authenticate your own API requests. Pipedream makes it easy by storing keys and tokens securely, and by managing the OAuth handshake and automatically refreshing the OAuth tokens behind the scenes.

For our last quickstart example, let's use Pipedream managed auth to connect to the Github API. First, create a new workflow with a **Schedule** trigger.

![image-20210517202200678](image-20210517202200678.png)

Next, click the **+** button and select the Github app:

![image-20210517202243362](image-20210517202243362.png)

This time, instead of selecting an action, select **Run Node.js with GitHub**:

![image-20210517202352166](image-20210517202352166.png)

Pipedream will add a code step scaffolded with a simple API request — you just need to connect your account, deploy the workflow, and run it. Click the **Connect GitHub** button and follow the steps in the popup window to connect your Github account:

![image-20210517202502976](image-20210517202502976.png)

When your account is connected, it will be listed for the step. **Deploy** your changes and click **Run Now**:

![image-20210517202551571](image-20210517202551571.png)

You will see the response from GitHub's API exported from the step.

![image-20210517202732984](image-20210517202732984.png)

Next, let's modify the code to create a repository named `Quickstart Test`. We can update the code based on GitHub's documentation for their REST API at https://docs.github.com/en/rest/reference/repos#create-a-repository-for-the-authenticated-user. Based on the documentation, we need to modify the URL path, change the method to `POST` and add a payload with a `name` parameter. Following is the updated code:

```javascript
return await require("@pipedreamhq/platform").axios(this, {
  url: `https://api.github.com/user/repos`,
  method: `post`,
  data: {
    name: `Quickstart Test`
  },
  headers: {
    Authorization: `Bearer ${auths.github.oauth_access_token}`,
  },
})
```

**Deploy** and run the workflow. When you inspect the return value for `steps.github` you should see the API response indicate the repo was created:

![image-20210517203328796](image-20210517203328796.png)

You can then go to GitHub to confirm the repo was created in your account:

![image-20210517203416665](image-20210517203416665.png)
